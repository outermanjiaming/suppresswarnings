<!doctype html>
<html lang="zh-cn">
<head>
    <meta name="viewport" content="initial-scale=1, user-scalable=0, minimal-ui" charset="UTF-8">
    <title>ç‚¹ä¸€äº¿ä¸ªèµ</title>
	<link rel="stylesheet" href="asset/css/style.css">
    <link rel="stylesheet" href="asset/plug-ins/dist/dropload.css">
	
	<link rel="stylesheet" href="https://cdn.bootcss.com/weui/1.1.3/style/weui.min.css">
	<link rel="stylesheet" href="https://cdn.bootcss.com/jquery-weui/1.2.1/css/jquery-weui.min.css">
</head>


<body>
<div id="main" class="main">

	<div id ="inner" class="inner">
	
	
		<header>
			<img id="bg" src="asset/images/bg.jpg">
			<p id="user-name">ä¸‡è™ç§‘æŠ€~è´¾ç´ æ°</p>
			<a href="./user.html"><img id="avt" class="data-avt" src="asset/images/0.jpg"></a>
		</header>
	
		

		<div style="padding-top:30px;">
			<!-- å·¦è¾¹ä¸»ä½“ -->
			<div class="po-left">
				<!-- å¤´åƒ -->
				<img src="asset/images/0.jpg">
			</div>
			<!--å³è¾¹ä¸»ä½“ -->
			<div class="po-right">
				<!--postä¸»ä½“-->
				<div class="po-hd">
					<!--æ˜µç§°-->
					<p class="po-name"><span class="data-name">ä¸‡è™ç§‘æŠ€~è´¾ç´ æ°</span></p>
					<div class="post">
						<!--æ–‡æœ¬-->
						<p>å¤§å®¶å¥½ï¼Œå¬è¯´å›½å†…å†»æˆç‹—ğŸ¶ï¼Ÿæˆ‘è¿™è¾¹è¿˜æŒºçƒ­ï½å¤§å®¶å¥½ï¼Œå¬è¯´å›½å†…å†»æˆç‹—ğŸ¶ï¼Ÿæˆ‘è¿™è¾¹è¿˜æŒºçƒ­ï½å¤§å®¶å¥½ï¼Œå¬è¯´å›½å†…å†»æˆç‹—ğŸ¶ï¼Ÿæˆ‘è¿™è¾¹è¿˜æŒºçƒ­ï½</p>
						<!--å›¾ç‰‡-->
						<p>
							<img class="list-img" src="asset/images/jt1.jpg" style="height: 80px;">
							<img class="list-img" src="asset/images/yt3.jpg" style="height: 80px;">
							<img class="list-img" src="asset/images/0.jpg" style="height: 80px;">
						</p>
					</div>
					<!--å‘å¸ƒæ—¶é—´-->
					<p class="time"><img id="invest_1" onclick="ajaxAddInvest(this.id)" class="c-icon" src="asset/images/c.png" style="padding-left:10px"></p>
					<!--ç‚¹èµ,è¯„è®º,è½¬å‘-->
					<img id="transmit_1" onclick="ajaxAddTransmit(this.id)" class="c-icon" src="asset/images/c.png" style="padding-left:10px">
					<img id="comment_1" onclick="ajaxAddComment(this.id)" class="c-icon" src="asset/images/c.png" style="padding-left:10px">
					<img id="like_1" onclick="ajaxAddLike(this.id)" class="c-icon" src="asset/images/c.png" style="padding-left:10px">
				</div>
				<div class="triangle"></div>
				<div class="cmt-wrap">
					<!--ç‚¹èµåˆ—è¡¨-->
					<div class="likes"><img src="asset/images/l.png"><span id="likes_1">è‹äº•ç©ºï¼Œé™ˆå† å¸Œï¼Œæ¨å¹‚ï¼Œç‹æ€èªï¼Œé™ˆèµ«ï¼Œåˆ˜å¾·åï¼Œé©¬äº‘...</span></div>
					<!--è¯„è®ºå’Œå›å¤-->
					<!--
					<div class="cmt-list">
						<p><span>wuä¸–å‹‹-EXOï¼š</span>ë‚˜ëŠ” ì„œëª…ï½</p>
						<p><span>é¹¿æ™—ï¼š</span>æˆ‘ä»¬åœ¨å›½å†…å†»æˆç‹—ï¼Œæˆ‘ä¹Ÿæƒ³è·Ÿå“¥æ‚¨å»çƒ­çƒ­ï½</p>
						<p><span>æƒå¿—é¾™ï¼š</span>ë‚˜ëŠ” ì„œëª…ï½</p>
						<p><span>ç‹æ€èªï¼š</span>å»å“ªç©å•Šï¼Ÿé‚£ä¹ˆçˆ½</p>
						<p>
							<span class="data-name">ä¸‡è™ç§‘æŠ€~è´¾ç´ æ°</span>
							å›å¤
									<span>
										ç‹æ€èª
									</span>
									<span>
										ï¼š
									</span>
							æ¾³æ´²å¤§å ¡ç¤ï¼Œè¿™è¾¹åˆšå¥½æ˜¯å¤å­£ï¼ŒæŒºé€‚åˆé¿å¯’çš„ã€‚
						</p>
						<p><span>æ¨å¹‚ï¼š</span>ğŸ˜˜ç§äººé£æœºå‡ºè¡Œï¼Œæ±‚å¸¦ä¸Šæˆ‘ï½</p>
					</div>
					-->
				</div>
			</div>
		</div>
		
		

		<ul id="list">
			
		</ul>

		
	</div>

</div>
<script src="https://cdn.bootcss.com/jquery/1.11.0/jquery.min.js"></script>

<script src="asset/plug-ins/dist/dropload.min.js"></script>

<script src="https://cdn.bootcss.com/jquery-weui/1.2.1/js/jquery-weui.min.js"></script>
<script>
var name ="å¼ ";

$(function(){


	 $.ajax({
		type: 'GET',
		url: '/index/asset/json/more.json',
		dataType: 'json',
		success: function(data){
			var result = addItems(data.list);
			// ä¸ºäº†æµ‹è¯•ï¼Œå»¶è¿Ÿ1ç§’åŠ è½½
			setTimeout(function(){
				$('#list').append(result);
				// æ¯æ¬¡æ•°æ®åŠ è½½å®Œï¼Œå¿…é¡»é‡ç½®
				dropload.resetload();
			},1000);
		},
		error: function(xhr, type){
			alert('Ajax error!');
			// å³ä½¿åŠ è½½å‡ºé”™ï¼Œä¹Ÿå¾—é‡ç½®
			dropload.resetload();
		}
	});



    // dropload
    var dropload = $('.inner').dropload({
        domUp : {
            domClass   : 'dropload-up',
            domRefresh : '<div class="dropload-refresh">â†“ä¸‹æ‹‰åˆ·æ–°</div>',
            domUpdate  : '<div class="dropload-update">â†‘é‡Šæ”¾æ›´æ–°</div>',
            domLoad    : '<div class="dropload-load"><span class="loading"></span>åŠ è½½ä¸­...</div>'
        },
        domDown : {
            domClass   : 'dropload-down',
            domRefresh : '<div class="dropload-refresh">â†‘ä¸Šæ‹‰åŠ è½½æ›´å¤š</div>',
            domLoad    : '<div class="dropload-load"><span class="loading"></span>åŠ è½½ä¸­...</div>',
            domNoData  : '<div class="dropload-noData">æš‚æ— æ•°æ®</div>'
        },
        loadUpFn : function(me){
            $.ajax({
                type: 'GET',
                url: '/index/asset/json/update.json',
                dataType: 'json',
                success: function(data){
                    var result = addItems(data.list);
                    // ä¸ºäº†æµ‹è¯•ï¼Œå»¶è¿Ÿ1ç§’åŠ è½½
                    setTimeout(function(){
                        $('#list').html(result);
                        // æ¯æ¬¡æ•°æ®åŠ è½½å®Œï¼Œå¿…é¡»é‡ç½®
                        dropload.resetload();
                    },1000);
                },
                error: function(xhr, type){
                    alert('Ajax error!');
                    // å³ä½¿åŠ è½½å‡ºé”™ï¼Œä¹Ÿå¾—é‡ç½®
                    dropload.resetload();
                }
            });
        },
        loadDownFn : function(me){
            $.ajax({
                type: 'GET',
                url: '/index/asset/json/more.json',
                dataType: 'json',
                success: function(data){
                    var result = addItems(data.list);
                    // ä¸ºäº†æµ‹è¯•ï¼Œå»¶è¿Ÿ1ç§’åŠ è½½
                    setTimeout(function(){
                        $('#list').append(result);
                        // æ¯æ¬¡æ•°æ®åŠ è½½å®Œï¼Œå¿…é¡»é‡ç½®
                        dropload.resetload();
                    },1000);
                },
                error: function(xhr, type){
                    alert('Ajax error!');
                    // å³ä½¿åŠ è½½å‡ºé”™ï¼Œä¹Ÿå¾—é‡ç½®
                    dropload.resetload();
                }
            });
        }
    });
});


function addItems(listData)
{
	var items = '';
	for(var i = 0; i < listData.length; i++)
	{
		items += getItem(listData[i]);
	}
	return items;
}


function getItem(itemData)
{
	var item =
		'<li class="item">'
			+'<div class="po-left">'
				+'<img src="'+itemData.face+'">'
			+'</div>'
			+'<div class="po-right">'
				+'<div class="po-hd">'
					+'<p class="po-name"><span class="data-name">'+itemData.uname+'</span></p>'
					+'<div class="post">'
						+'<p>'+itemData.content+'</p>'
						+'<p>'+getImgs(itemData.images)+'</p>'
					+'</div>'
					+'<p class="time"><img class="c-icon" src="asset/images/c.png" style="padding-left:10px"></p>'
					+'<img class="c-icon" src="asset/images/c.png" style="padding-left:10px">'
					+'<img class="c-icon" src="asset/images/c.png" style="padding-left:10px">'
					+'<img class="c-icon" src="asset/images/c.png" style="padding-left:10px">'
				+'</div>'
				+'<div class="triangle"></div>'
				+'<div class="cmt-wrap">'
					+'<div class="likes"><img src="asset/images/l.png">'+getLikes(itemData.likes)+'</div>'
				+'</div>'
			+'</div>'
	   +'</li>'
	return item;
}


function getImgs(imgUrls)
{	
	var imgs = "";
	var imgUrlArr = new Array();
	imgUrlArr = imgUrls.split(",");
	for(var i=0; i<imgUrlArr.length; ++i)
	{
		imgs += '<img class="list-img" src="'+imgUrlArr[i]+'" style="height: 80px;">';
	}
	return imgs;
}


function getTime(addtime)
{
	return "åˆšåˆš";
}


function getLikes(likeArr)
{
	var likes = "";
	for(var i=0; i<likeArr.length; ++i)
	{
		likes += likeArr[i]+'ï¼Œ';
	}
	likes = likes.substr(0,likes.length-1);
	likes += "...";
	return likes;
}




function ajaxAddLike(id)
{
	var rowId = id.split("_")[1];
	$.ajax({
		type: 'POST',
		url: '/index/add.php',
		dataType: 'json',
		success: function(data){
			if(data.code == 0)
			{
				var likesHtml = $("#likes_"+rowId).html();
				$("#likes_"+rowId).html(name+"ï¼Œ"+likesHtml);	
				$.toast("æ“ä½œæˆåŠŸ", "text");
			}
			else
			{
				$.toast("æ“ä½œå¤±è´¥", "text");
			}
		},
		error: function(xhr, type){
			alert('Ajax error!');
		}
	});
}


function ajaxAddComment(id)
{
	$.ajax({
		type: 'POST',
		url: '/index/add.php',
		dataType: 'json',
		success: function(data){
			console.log(data);
		},
		error: function(xhr, type){
			alert('Ajax error!');
		}
	});
}


function ajaxAddTransmit(id)
{

}


function ajaxAddInvest(id)
{
	$.prompt({
	  text: "åå­—ä¸èƒ½è¶…è¿‡6ä¸ªå­—ç¬¦ï¼Œä¸å¾—å‡ºç°ä¸å’Œè°æ–‡å­—",
	  title: "æŠ•èµ„é‡‘é¢",
	  onOK: function(text) {
		$.ajax({
			type: 'POST',
			url: '/index/add.php',
			dataType: 'json',
			success: function(data){
				$.toast("æ“ä½œæˆåŠŸ", "text");
			},
			error: function(xhr, type){
				alert('Ajax error!');
			}
		});
	  },
	  onCancel: function() {
		console.log("å–æ¶ˆäº†");
	  },
	  input: 'Mr Noone'
	});
}
</script>
</body>
</html>